<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.21.1"/><meta data-react-helmet="true" name="description" content="Multi Thread 환경에서 Thread 는 어떻게 Cpu 에서 동작하며, 공유자원을 사용하지는지, 동기화는 무엇이며 무엇을 해결하는지 알아보자"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="Multi Thread 환경에서 동기화(Synchronized)의 필요 이유"/><meta data-react-helmet="true" property="og:description" content="Multi Thread 환경에서 Thread 는 어떻게 Cpu 에서 동작하며, 공유자원을 사용하지는지, 동기화는 무엇이며 무엇을 해결하는지 알아보자"/><meta data-react-helmet="true" property="og:image" content="/static/529180095f316c31e09416bcc12ab7b9/Sync_thum.png"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="Multi Thread 환경에서 동기화(Synchronized)의 필요 이유"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Multi Thread 환경에서 동기화(Synchronized)의 필요 이유"/><meta data-react-helmet="true" name="twitter:description" content="Multi Thread 환경에서 Thread 는 어떻게 Cpu 에서 동작하며, 공유자원을 사용하지는지, 동기화는 무엇이며 무엇을 해결하는지 알아보자"/><meta data-react-helmet="true" name="twitter:image" content="/static/529180095f316c31e09416bcc12ab7b9/Sync_thum.png"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><meta data-react-helmet="true" name="google-site-verification" content="Kqjqe5wmyUS1xGrvn9c-6CHtk2bxO_6GjrtIkUhFAp4"/><style data-href="/styles.ab33764ee8026509192d.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#ccc}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.inserted{color:green}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><title data-react-helmet="true">Multi Thread 환경에서 동기화(Synchronized)의 필요 이유</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="canonical" href="https://comtrial.github.io/동기화%20synchronize/" data-baseprotocol="https:" data-basehost="comtrial.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 4f3yow">.css-4f3yow{display:grid;grid-template-columns:repeat(24, 1fr);width:100vw;height:100vh;}@media (max-width: 1200px){.css-4f3yow{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media (max-width: 768px){.css-4f3yow{width:100vw;height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="css-4f3yow e1strnqo0"><style data-emotion="css-global 1v3prin">*{padding:0;margin:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:-.01em;color:#292b2c;}*::-webkit-scrollbar{display:none;}html,body,#___gatsby{height:100%;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css x5y173">.css-x5y173{grid-column-end:span 6;padding:80px 0 0 80px;width:100%;display:block;font-size:14px;}@media (max-width: 1200px){.css-x5y173{grid-column-start:8;grid-column-end:18;padding:80px 80px;max-width:800px;min-width:650px;margin:0 auto;}}@media (max-width: 768px){.css-x5y173{width:100%;min-width:0;padding:14px 14px 14px 14px;}}</style><div class="css-x5y173 e160b014"><style data-emotion="css 1o6qhld">.css-1o6qhld{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;}@media (max-width: 768px){.css-1o6qhld{width:100%;}}</style><div class="css-1o6qhld e160b013"><style data-emotion="css yw2x09">.css-yw2x09{font-size:16px;font-weight:700;margin-bottom:15px;}@media (max-width: 768px){.css-yw2x09{font-size:16px;}}</style><div class="css-yw2x09 e160b011">Choi Seungwon</div><br/><div><style data-emotion="css z78eiy">.css-z78eiy{font-size:16px;font-weight:400;}@media (max-width: 768px){.css-z78eiy{font-size:13px;}}</style><div class="css-z78eiy e160b012">Nice to Meet You,</div><div class="css-yw2x09 e160b011">I&#x27;m Junior Software Engineer.</div></div><br/><style data-emotion="css 1fledxx">.css-1fledxx{font-size:14px;font-weight:400;margin-bottom:15px;}@media (max-width: 768px){.css-1fledxx{font-size:12px;}}</style><div class="css-1fledxx e160b010"><a href="mailto:comtrial97@gmail.com" target="_blank" rel="noreferrer"><u>Contact →</u></a><br/><a href="https://github.com/comtrial" target="_blank" rel="noreferrer"><u>Github →</u></a></div></div></div><style data-emotion="css 1u219so">.css-1u219so{grid-column-start:7;grid-column-end:19;margin:0 auto;min-width:500px;max-width:580px;width:100%;overflow:scroll;}@media (max-width: 1200px){.css-1u219so{margin:0 auto;padding:0 40px;overflow:visible;}}@media (max-width: 768px){.css-1u219so{min-width:100%;padding:0;}}</style><div class="css-1u219so e6b6ljm0"><style data-emotion="css 1udceki">.css-1udceki{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:15px 0;margin-top:65px;position:-webkit-sticky;position:sticky;top:0;background-color:white;z-index:10;}@media (max-width: 1200px){.css-1udceki{width:100%;margin:0;padding:0 20px;}}</style><div class="css-1udceki e1kn8q5k1"><style data-emotion="css 1rchos1">.css-1rchos1{margin-right:20px;padding:5px 0;font-size:14px;font-weight:500;font-weight:650;-webkit-text-decoration:underline;text-decoration:underline;text-underline-offset:5px;cursor:pointer;}.css-1rchos1:last-of-type{margin-right:0;}@media (max-width: 768px){.css-1rchos1{font-size:12px;}}</style><a class="css-1rchos1 e1kn8q5k0" href="/?category=All">#All</a><style data-emotion="css 19kzyt2">.css-19kzyt2{margin-right:20px;padding:5px 0;font-size:14px;font-weight:500;font-weight:500;-webkit-text-decoration:none;text-decoration:none;text-underline-offset:5px;cursor:pointer;}.css-19kzyt2:last-of-type{margin-right:0;}@media (max-width: 768px){.css-19kzyt2{font-size:12px;}}</style><a class="css-19kzyt2 e1kn8q5k0" href="/?category=Java">#Java</a><a class="css-19kzyt2 e1kn8q5k0" href="/?category=OS">#OS</a></div><style data-emotion="css 163yfv7">.css-163yfv7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;width:100%;box-sizing:border-box;overflow:hidden;}</style><div class="css-163yfv7 e1opi4mu2"><style data-emotion="css 1j4frpp">.css-1j4frpp{width:100%;padding:20px 0;object-fit:cover;overflow:hidden;}</style><div class="css-1j4frpp e1opi4mu1"><style data-emotion="css 1pkizp7">.css-1pkizp7{z-index:-1;border-radius:5px;-webkit-background-size:contain;background-size:contain;object-fit:contain;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-1pkizp7 e1opi4mu0"><div style="max-width:814px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;543&#x27; width=&#x27;814&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADSElEQVQ4yyWSW28aBxCF+QV9ScAQB1+4LGa5LBfvLizLLqzBYGC52QZsx6axY6chtVvZktumSftSq43UtFXlSm6rJpHlCqdV1P7Dr4I+jDQzD985ozOO+XgSf3KZYEomLGeRNJNk3iJllinU19ErLaRcEcVao7X1IXJhlYiaI5bNI6QUslYFn5TCHRIRUjIOKWeiFFfRyzWMapNyu0drsEezt8vJ6TMOR2dU2n0Gw0NefH1Bf/eAxsY21XYPv5SmULWnwEBSRsoZOORCCbPapL6xzfBwxGdPRnwzOuLb519xdXnFm9/+4Oz8Bb9cXnF7fcPLlz/y+PiMo6ef0B8eUtvYRi2WaQ92kbQ8jljOIlu2qW7scDx8wJd1g9FWj/H4HW9eX/P25m9uxu+5efcP47/+5fr2PT//+prb8Z/8/vaGV5dXXHz/A9+9+onZUBhHPGdRXmtglcoUCyb1nIqSyVJqdzn56AkPR+ecPLtg/9Pn7J98wcenn7N38IjdvQfYnQ72eofmYIfaeo/7oSUcsmGxulbnrN+mb+l4hBBun48P5hYJh0XUfAnRqBPSKySKNlmjSEiS0AyTVEZDNQtUWptE5Az3ggIOUc6wYprsWHm0RBxPIMhiVEKMSyQmpRWIth4RMhuIpXUy9QF5U0dUVEr2xOGARrdHOC0z4w/gmI8lWFZU5HQaMZFkPhJjTowRjCUw7S06Ww+Ryl1ynSGN7SPy9hZWp4tSqeIWlvAn0qR0g6CUxLnow+EJiXij0jT6xWgcjxifulvKrqBvHzMYPkYotLCGpwyfnpPSV5hRKki1PslKndlwZPqDXjHKTED4HzhRcvmDuHwB3Jky8+k8XtkiaB9Qqncxi2XE9iFKd597RguXZuNMmEiVdYp2B188gSu4hGeSspBITVU8whJuIYxbLeHK1pjN23iru3RabdKawWxxk/tWD0++jVtv415ewRnTiFlNjJo9hTr9Ag5vOMJCND6Funx+ZkIiLq3GXaOLW6vhjSa4E9O4q1Rxak2c6hrOSZ8u4Ywo3BFlhFwVxSrji0s4JqfOBILThCY1mefUFQKlTXxmg4W0jk+18Bc7+Ke7Ngv5Jot6g3nZYiFt4JVLBNQikYzOf/qB0TaDbCyHAAAAAElFTkSuQmCC" alt=""/><picture><source type="image/webp" data-srcset="/static/529180095f316c31e09416bcc12ab7b9/a6bdf/Sync_thum.webp 204w,/static/529180095f316c31e09416bcc12ab7b9/df0a2/Sync_thum.webp 407w,/static/529180095f316c31e09416bcc12ab7b9/d45cf/Sync_thum.webp 814w" sizes="(min-width: 814px) 814px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 814px) 814px, 100vw" decoding="async" loading="lazy" data-src="/static/529180095f316c31e09416bcc12ab7b9/18f49/Sync_thum.png" data-srcset="/static/529180095f316c31e09416bcc12ab7b9/aaef4/Sync_thum.png 204w,/static/529180095f316c31e09416bcc12ab7b9/6884d/Sync_thum.png 407w,/static/529180095f316c31e09416bcc12ab7b9/18f49/Sync_thum.png 814w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/529180095f316c31e09416bcc12ab7b9/a6bdf/Sync_thum.webp 204w,/static/529180095f316c31e09416bcc12ab7b9/df0a2/Sync_thum.webp 407w,/static/529180095f316c31e09416bcc12ab7b9/d45cf/Sync_thum.webp 814w" sizes="(min-width: 814px) 814px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 814px) 814px, 100vw" decoding="async" loading="lazy" src="/static/529180095f316c31e09416bcc12ab7b9/18f49/Sync_thum.png" srcSet="/static/529180095f316c31e09416bcc12ab7b9/aaef4/Sync_thum.png 204w,/static/529180095f316c31e09416bcc12ab7b9/6884d/Sync_thum.png 407w,/static/529180095f316c31e09416bcc12ab7b9/18f49/Sync_thum.png 814w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><style data-emotion="css p5tuz0">.css-p5tuz0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;height:200px;padding:60px 0;padding:0 20px;}@media (max-width: 768px){.css-p5tuz0{width:100%;padding:20px 20px;}}</style><div class="css-p5tuz0 e1st1jau2"><style data-emotion="css kbgudh">.css-kbgudh{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;text-overflow:ellipsis;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:30px;font-weight:600;}@media (max-width: 768px){.css-kbgudh{font-size:24px;}}</style><div class="css-kbgudh e1st1jau1">Multi Thread 환경에서 동기화(Synchronized)의 필요 이유</div><style data-emotion="css 1on72x2">.css-1on72x2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:20px;font-size:14px;font-weight:500;}@media (max-width: 768px){.css-1on72x2{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:12px;font-weight:400;}}</style><div class="css-1on72x2 e1st1jau0"><div>Java / OS</div><div>2023.08.20.</div></div></div></div><style data-emotion="css 1gvfp6l">.css-1gvfp6l{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;word-break:break-all;box-sizing:border-box;line-height:1.5;font-size:15px;font-weight:400;letter-spacing:-.01em;color:#343a40!important;}.css-1gvfp6l img{display:block;max-height:500px;width:auto;margin:0 auto;padding:0 20px;object-fit:cover;}.css-1gvfp6l span+em,.css-1gvfp6l img+em{display:block;text-align:center;font-size:12px;}.css-1gvfp6l p{padding:14px 0;color:#343a40!important;}.css-1gvfp6l strong{background:#333e;border-radius:2px;color:rgb(256, 256, 256)!important;font-weight:400;padding:2px;}.css-1gvfp6l h1,.css-1gvfp6l h2,.css-1gvfp6l h3,.css-1gvfp6l h4{font-weight:600;}.css-1gvfp6l *+h1,.css-1gvfp6l *+h2,.css-1gvfp6l *+h3,.css-1gvfp6l *+h3{margin-top:60px;}.css-1gvfp6l h1{font-size:20px;font-weight:700;}.css-1gvfp6l h2{font-size:18px;font-weight:700;}.css-1gvfp6l h3{font-size:16px;font-weight:700;}.css-1gvfp6l h4{font-size:15px;font-weight:700;}.css-1gvfp6l blockquote{margin:10px 0;padding:0px 15px;border-left:0.8px solid #000000;font-weight:500;}.css-1gvfp6l ol,.css-1gvfp6l ul{margin-left:20px;padding:20px 0;}.css-1gvfp6l hr{border:0.8px solid rgb(210, 210, 210);background:rgb(210, 210, 210);margin-bottom:30px;}.css-1gvfp6l a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-1gvfp6l pre[class*='language-']{margin:30px 0;padding:14px;font-weight:500;font-size:12px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace!important;background:rgba(240, 240, 240, 0.5);border-radius:4px;}.css-1gvfp6l pre[class*='language-']::-webkit-scrollbar-thumb{background:rgba(245, 255, 255, 0.5);border-radius:4px;}@media (max-width: 768px){.css-1gvfp6l{width:100%;padding:20px 20px;font-size:14px;}.css-1gvfp6l h1{font-size:20px;}.css-1gvfp6l h2{font-weight:700;font-size:18px;}.css-1gvfp6l h3{font-weight:600;font-size:16px;}.css-1gvfp6l h4{font-weight:600;font-size:14px;}.css-1gvfp6l img{width:auto;max-height:300px;padding:0 10vw;object-fit:cover;}.css-1gvfp6l hr{margin-bottom:30px;}}</style><div class="css-1gvfp6l e1ijh0y10"><h2>Thread pool</h2>
<hr>
<p>웹 서버가 사용자의 요청들을 처리하는 여러 방법 중에 <strong>Thread per request</strong> 환경을 보면<br>
사용자의 Request 를 Queue 에 담아 논 후 Thread Pool 에서 사용이 끝난 후 반납된 Thread 에 해당 요청 작업을 수행 시키게 된다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d6298ca88cf1f0438f3404babef63afd/2cbcd/thread_per_req.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbElEQVQoz5WSz07CQBDGt2Xb7tJWSFP6hwKlhCYSDEYuXuDCWQ6+Aok3E06cPPIaPoQP4Dv4KCaedT/TtS2lUdHDl5nZnfnt7O4QQsirYRiwLEtwzoVpWchiQsh/JHL7TjLHcRwxHA7h+z7CwIPrun8CTcIQN7MZbMaq0NIRVOcI42lZoChKDaJIqaoq4/vVCs+7HRilkqEqiqgCoRscXjeRBZRSqVNdRq0WHtZrXPb7xRrBWbsD026XSQWQcw7GmPQNg6E7SBH0RvCjEaLBWOaeByEeNxss0vQA7MYTuEEsFyjVJDCTruuwLBuaRqEbDHF6if7oAr1king8k/ktxnAVRXCazQOwruztsq40TSs7Lt6tvEVuU8/Dy36P2/n8GKjpDKxpo9FoSFgGrUPKA3N7nSS4WyzgmmZ1/+tT3GAositVCzP4d0A1//3Ncomn7RYd2xb5QYLUBvO48IcOTww3efsNekr5rBa1H5/hcfORS0UH+gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/d6298ca88cf1f0438f3404babef63afd/a59e9/thread_per_req.webp 192w,
/static/d6298ca88cf1f0438f3404babef63afd/0ca9f/thread_per_req.webp 384w,
/static/d6298ca88cf1f0438f3404babef63afd/83502/thread_per_req.webp 764w"
              sizes="(max-width: 764px) 100vw, 764px"
              type="image/webp"
            />
          <source
            srcset="/static/d6298ca88cf1f0438f3404babef63afd/3b721/thread_per_req.png 192w,
/static/d6298ca88cf1f0438f3404babef63afd/66595/thread_per_req.png 384w,
/static/d6298ca88cf1f0438f3404babef63afd/2cbcd/thread_per_req.png 764w"
            sizes="(max-width: 764px) 100vw, 764px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/d6298ca88cf1f0438f3404babef63afd/2cbcd/thread_per_req.png"
            alt="Imgae"
            title="Imgae"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
<em>[그림1] Thread per request 에서의 처리 방식</em></p>
<p>이러한 상황에서 여러 Thread 가 static 변수 등의 여러 Thread 와 공유하는 데이터가 존재하는<br>
Heap 영역에 접근해서</p>
<p><em>값의 수정이 일어 나게 되면</em></p>
<p>과연 그 값의 수정은 개발자의 의도대로 정상 작동할까?</p>
<h2>의도대로 작동하지 않는 코드</h2>
<hr>
<p>우선 예시로 여러 개의 Thread 가 수행되고 있는 환경에서 어떤 문제가 생길 수 있을까</p>
<p>통장 잔고를 확인 후 출금하고자 하는 금액(100~300 random) 보다 클 경우 출금 후
잔여급액을 출력하는 코드를 통해 발생하는 문제를 알아보자.</p>
<ol>
<li>우선 아래와 같이 withdraw 함수를 수행하는 Accout class 를 작성해준다.</li>
</ol>
<p>withdraw 함수에서 잔여 금액 확인 후 조건을 만족 할 경우 Thread sleep 이후 잔여 금액에서 차감시켜 줍니다.
(Thread 를 의도적으로 sleep 시켜 Context Switching 이 발생하도록 작성해 준다.)</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">Thread</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadStaticAccount</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> remainMoney <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRemainMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> remainMoney<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//해당 시점에서 remainMoney 값을 메모리에서 읽어온 시점에서는 아래 조건이 true 이나</span>
        <span class="token comment">//Thread 의 Context Switching 이 발생함에 따라 데이터 값이 변동 될 수 있다.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>remainMoney <span class="token operator">>=</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token comment">// Thread 의 처리 속도가 빨라서 sleep 을 줘서 Context Switching 이 발생하도록</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            remainMoney <span class="token operator">-=</span> money<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Not enough money"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ol start="2">
<li>Thread 를 구현하기 위한 TaskRunnable class 를 구현해 준다.</li>
</ol>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">Thread</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TaskRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token class-name">ThreadStaticAccount</span> threadStaticAccount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadStaticAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>threadStaticAccount<span class="token punctuation">.</span><span class="token function">getRemainMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> money <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
            threadStaticAccount<span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"remain Volume: "</span> <span class="token operator">+</span> threadStaticAccount<span class="token punctuation">.</span><span class="token function">getRemainMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ol start="3">
<li>new TaskRunnable() 을 통해 Runnable 객체를 생성한 후 2개의 Thread 를 start 시켜준다.</li>
</ol>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">Thread</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MultiThreadSyncTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Runnable</span> run <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TaskRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>의도한 코드에 의하면 어떤 결과가 나와야 되는가?</p>
<p>ThreadStaticAccount 의 withdraw() 메서드 실행시 잔여금액(remainMoney)을 확인 후<br>
출금하고자 하는 금액(money)보다 충분하다는 조건을 통과한 후에 해당 금액을 차감한 양의 금액이 나와야 한다.<br>
(잔여금액을 확인 후 출금하고자 하는 금액보다 충분하다는 조건을 만족했기에)</p>
<p>하지만 결과는 아래와 같다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">700</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">700</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">400</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">400</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">200</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">200</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">200</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token number">0</span>
remain <span class="token class-name">Volume</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">100</span></code></pre></div>
<p>어째서 위와 같은 경우가 발생하는가</p>
<h2>Multi Thread 의 CPU 에서의 동작</h2>
<hr>
<p>우리가 작성한 코드 (User level) 은 메모리 영역에서 아래와 같이 올라간다</p>
<p>JVM 환경은 user thread 와 os thread (kernel thread) 는 one to one 방식으로 매핑한다.</p>
<p>위 말인 즉슨 JVM 환경에서는 Thread 스케줄링은 OS 에게 위임한다는 의미이다.</p>
<p>따라서 아래와 같이 각각의 Thread 가 스케줄링 될 경우, 시점에 따라서 Heap 에서 공유되어 동기화화될 것이라
믿었던 static 변수의 값이 이전 작업 Thread 에 의해 수정이 발생할 수도 있다는 것이다.</p>
<p>eg. static 변수 int state 를 multi thread 환경에서 add() { state++; } 연산</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 759px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a004fffc0883610299af50b7dbf7ffb8/db779/thread_using_heap.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 63.541666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACYUlEQVQ4y5VTPW/TUBR9tvP8ka86qR3XcUgdEqe0jRqniYpIhcpQFVwaqVClUgda0QGhDh0QS4cGCYYwhCn8AgL/gz/Ab2ApOwtCYshB7zkxFOjAcHTv9b3v6Precwkh5DshBISQ8cRyiKIEURAgMF8QEIvFQIjAc8Ik5vmwZvr2B/kXGYPj5EFVNYrzTh6yTLnPrO04+OPNlCNyxrKahBKfAVVTMGZNLMzNoWwYqBgGbDMHNalD0dKgWhqFnIWFXA6eacLNZses2wnXhFAQUG11sHb3CWobh1hZXMOn589w0X+Nzy96uN9aR/nWPtrBU8y3dvFo/Q4uXr3El34fH09PkVKUsFNN02DbNp+Ju9TGjeY9lBtbqJZreLvfxej4GO+ODtFeqsNZ2sBiK4CzeBtbK6t4f3SED4+P8WZvD+l4PCSUJAmyLIezUTRQWYUksYGL4eBFMVySJCKVTEBVKGQqQaIxUE1jBCCTmukMo83lCy5sZx6ZrIF0Ko2q66JUKMDMZKDrGVybL8OyC0ikdBjZWSyUSnAsC7MzM1wNlwinUGQZiqLwzhKJBLcCgxBCYvLhfigpmVJILH8VIQMbg3j5N/4Hv2RjmiaKxSI8z+NW1/Wo0LIsLC8vo16v8zyLK5UKfN/n39li/yLsdrs4Pz/H2dkZer0eNjc3I0Lfb2D3wUME29sIggCNRgPbQYDOzg46nc642WxGOoxUfnJygsFggOFwiNFohIODg8nCCK6XPdRXb6LiVXlnVa+KNd+HX6vx2HXd6FK+XnV+v4NJSFHChamqymMmNzmMx5Tys/z2E2ZfS5wAtcrRAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/a004fffc0883610299af50b7dbf7ffb8/a59e9/thread_using_heap.webp 192w,
/static/a004fffc0883610299af50b7dbf7ffb8/0ca9f/thread_using_heap.webp 384w,
/static/a004fffc0883610299af50b7dbf7ffb8/8bce2/thread_using_heap.webp 759w"
              sizes="(max-width: 759px) 100vw, 759px"
              type="image/webp"
            />
          <source
            srcset="/static/a004fffc0883610299af50b7dbf7ffb8/3b721/thread_using_heap.png 192w,
/static/a004fffc0883610299af50b7dbf7ffb8/66595/thread_using_heap.png 384w,
/static/a004fffc0883610299af50b7dbf7ffb8/db779/thread_using_heap.png 759w"
            sizes="(max-width: 759px) 100vw, 759px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/a004fffc0883610299af50b7dbf7ffb8/db779/thread_using_heap.png"
            alt="thread using heap memory on cpu"
            title="thread using heap memory on cpu"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
<em>[그림2] Cpu 관점에서 Thread Context switching 과정의 Heap memory 데이터 연산</em></p>
<h2>JVM 환경에서의 동기화 해결책</h2>
<hr>
<p>[그림2] 싱황을 고려하여 앞서 살펴본 코드예제에서
static 변수를 의도대로 참고하기 위해선 값을 유지해야하는 발생하는 메서드에 synchronized 를 선언해 줌으로써 같은 상황을 방지 할 수 있다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadStaticAccount</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>remainMoney <span class="token operator">>=</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre></div>
<p>synchronized 키워드를 통해 Thread 간의 Context switching 이 발생하여 Data 의 안정성과 신뢰성을
보장할 수 있는 Thread-safe 한 환경을 만들어 줄 수 있다.</p>
<h2>Thread-safe 사용 예: StringBuilder 와 StringBuffer</h2>
<p>해당 동기화 개념이 실제로 쓰이는 사례 중 StringBuilder 와 StringBuffer의 예시가 있다.</p>
<p>공식 문서 확인 시 StringBuffer 는 Thread safe 하다 라고 나와 있는 것이</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b7d22bcf1c3b114fbd228071c98303ff/e80ce/StringBuffer_ref.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.854166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVQoz5WT2W7bMBBF9f9fUqDfUaCPLZIutmNZomRrI8VNW+LIpyCdBn4KnAGONCTEO3MHVNL3PaIocM6zPL8wzQvjNLOuKyEulwufiaSVit+bPWle8GeX8uPXhoe/O4Zxehf8jGgSutJ2QPYW64fY2W13t4L3CCfzslA3DVmeU5QlQuS0bcPlTfR/3Ip/ROK9J8sF6SEjFwW5KNmnB05VHWcaWD9jOTzcMCG1w7gBZRy99fi3PaUtwcX5fL6LZBwHvLfM00jIr2uHtQalJFr3rOtr8Pw+349I2s6w2WYUR4k4SWRvsM6jjUWqHtlrxnnh/LreZ9nr71T5F9ryK6p7pOkMbSfppMJYS93KSLhe1lr84Alzn5fnyDAEV2Pcc86RaPmA7r7xMv1kHo84d7UcPgj2g+XwNkYTfoIwikC4p34YMcbEQlrrmCdSWQ7ZCSFqhCgRhaAsy0iWZVFEG804XQ8HnLOxUMA6G9ehYBBOVC9J0yee9rvIdreNQsfTMYoqpeLBpmli3nUdUkqMNbRtS1WdqOuapm2oqop/HBScHAvyETcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b7d22bcf1c3b114fbd228071c98303ff/a59e9/StringBuffer_ref.webp 192w,
/static/b7d22bcf1c3b114fbd228071c98303ff/0ca9f/StringBuffer_ref.webp 384w,
/static/b7d22bcf1c3b114fbd228071c98303ff/1b3b6/StringBuffer_ref.webp 563w"
              sizes="(max-width: 563px) 100vw, 563px"
              type="image/webp"
            />
          <source
            srcset="/static/b7d22bcf1c3b114fbd228071c98303ff/3b721/StringBuffer_ref.png 192w,
/static/b7d22bcf1c3b114fbd228071c98303ff/66595/StringBuffer_ref.png 384w,
/static/b7d22bcf1c3b114fbd228071c98303ff/e80ce/StringBuffer_ref.png 563w"
            sizes="(max-width: 563px) 100vw, 563px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b7d22bcf1c3b114fbd228071c98303ff/e80ce/StringBuffer_ref.png"
            alt="Imgae"
            title="Imgae"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
<em>[그림3] StringBuffer 공식 문서 (<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/StringBuffer.html" target="_blank" rel="nofollow">https://docs.oracle.com/javase/7/docs/api/java/lang/StringBuffer.html</a>)</em></p>
<p>위의 동기화 개념이 적용 된 것이다.</p>
<p>실제 소스 코드에서도 synchronized 를 선언해 줌으로써 StringBuffer 가 동기화에 있어서 보장해주고 있다는 것을 확인 할 수 있다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ac97761afd9989e8eaa68477c1011175/46352/stringBuffer_code.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 80.72916666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABwElEQVQ4y42UW47bMAxFvZxafFOyE8fTovvf1C2kpE46caf9OCBpUMQlKXkiYeQtkHvAr47cHfUjUPc4bKwGDRmIC8T4GRuDiFBKGXYSIUQwMgW1KqIFvAUsFOIMFh7JZX6hfPIfxbqdmAq2qvj5ccX324plXXHZdkRWMMuR/C8OhUQMUYN5ovvzt/lcyfyu6pWnQiZYE2gVeNMxL+8sn60OPy4Ga3rM06qC+EUhCyE3R+2L2Xzwu2i3vYA/7BEvCk0Z9GJ/ttwVrgZbDFoVtijYCNy3x+V+4BW6W9a+MHpvWZXRVsWyGlpTZAtkS0QNiOjpvP42v3vLVHBJxY/9gv26YF2vWC83ZF1g7v+15decqYwtOyIb+EtF74fPmEwJNQuEZ1ApYCL0zYvI8GnEfKrmtKArYU1Cc0IqIZTQUpHhw/d+R9Uwl/ltXqcthxG2hVCd4HKnhSDDECYwYag43BwqMrr4UmFvT4Wg/MSVoSqQ3npvmbov48BcCuZ5PmVcm3DCtpah0B4Kwxit/yz6S1CBZ8KjE0hjuPt46/1bZN59jzH3qavohQ66QmOkyyiswjDzgZqNHFV9xgOHqo3l/QKI4ulcZE2iwQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/ac97761afd9989e8eaa68477c1011175/a59e9/stringBuffer_code.webp 192w,
/static/ac97761afd9989e8eaa68477c1011175/0ca9f/stringBuffer_code.webp 384w,
/static/ac97761afd9989e8eaa68477c1011175/dc9b9/stringBuffer_code.webp 768w,
/static/ac97761afd9989e8eaa68477c1011175/e2c2f/stringBuffer_code.webp 1152w,
/static/ac97761afd9989e8eaa68477c1011175/f3efb/stringBuffer_code.webp 1536w,
/static/ac97761afd9989e8eaa68477c1011175/6a898/stringBuffer_code.webp 1542w"
              sizes="(max-width: 768px) 100vw, 768px"
              type="image/webp"
            />
          <source
            srcset="/static/ac97761afd9989e8eaa68477c1011175/3b721/stringBuffer_code.png 192w,
/static/ac97761afd9989e8eaa68477c1011175/66595/stringBuffer_code.png 384w,
/static/ac97761afd9989e8eaa68477c1011175/fe486/stringBuffer_code.png 768w,
/static/ac97761afd9989e8eaa68477c1011175/d2d74/stringBuffer_code.png 1152w,
/static/ac97761afd9989e8eaa68477c1011175/e8464/stringBuffer_code.png 1536w,
/static/ac97761afd9989e8eaa68477c1011175/46352/stringBuffer_code.png 1542w"
            sizes="(max-width: 768px) 100vw, 768px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/ac97761afd9989e8eaa68477c1011175/fe486/stringBuffer_code.png"
            alt="Imgae"
            title="Imgae"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
<em>[그림4] StringBuffer source code</em></p>
<p>여기까지 Multi Thread 환경에서 발생할 수 있는 문제점과 이를 해결하기 위한 synchronized 키워드를 정리하였습니다.</p>
<p>Trade-off 는 synchronized 사용시 Thread-safe 를 보장하지만, synchronized 메서드가 많을 수록 멀티스레드는 병목현상을 겪게 됩니다.</p>
<p>이는 멀티 스레드를 사용하지만, 싱글 스레드처럼 동작한다는 것입니다.</p>
<p>따라서 작성하고자 하는 코드의 목적에 적합하게 사용해야 합니다.</p>
<br>
<br>
<p>reference</p>
<blockquote>
<ul>
<li><a href="https://product.kyobobook.co.kr/detail/S000001032977" target="_blank" rel="nofollow">자바 성능 튜닝 이야기 - static 제대로 한번 써보자</a></li>
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/StringBuffer.html" target="_blank" rel="nofollow">Java String Buffer</a></li>
</ul>
</blockquote>
<blockquote>
<p>부족한 글 읽어주셔서 진심으로 감사드리며, 잘못된 부분이나 개선점은 무심하게라도 알려주시면 너무 감사하겠습니다.</p>
</blockquote></div><style data-emotion="css 124boz7">.css-124boz7{padding:120px 0;}@media (max-width: 768px){.css-124boz7{padding:0 20px;}}</style><div class="css-124boz7 e1gqsjds0"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/동기화 synchronize/";window.___webpackCompilationHash="4b40cb3441a14967e735";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c9fa82aa5b1f9c65f078.js"],"app":["/app-d793487d2519541d78a1.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-c60ccaac012592267949.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-84053ab5c15c6e7b5729.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-f9f9aa1088516efccdd4.js"]};/*]]>*/</script><script src="/polyfill-c9fa82aa5b1f9c65f078.js" nomodule=""></script><script src="/app-d793487d2519541d78a1.js" async=""></script><script src="/framework-c45ea1cbb39153ed5c73.js" async=""></script><script src="/webpack-runtime-0ebabd170e12628f3d25.js" async=""></script></body></html>